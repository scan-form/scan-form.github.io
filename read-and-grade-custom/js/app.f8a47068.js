(function(t){function e(e){for(var a,r,l=e[0],o=e[1],c=e[2],h=0,f=[];h<l.length;h++)r=l[h],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&f.push(i[r][0]),i[r]=0;for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(t[a]=o[a]);u&&u(e);while(f.length)f.shift()();return n.push.apply(n,c||[]),s()}function s(){for(var t,e=0;e<n.length;e++){for(var s=n[e],a=!0,l=1;l<s.length;l++){var o=s[l];0!==i[o]&&(a=!1)}a&&(n.splice(e--,1),t=r(r.s=s[0]))}return t}var a={},i={app:0},n=[];function r(e){if(a[e])return a[e].exports;var s=a[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=t,r.c=a,r.d=function(t,e,s){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(s,a,function(e){return t[e]}.bind(null,a));return s},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/read-and-grade-custom/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],o=l.push.bind(l);l.push=e,l=l.slice();for(var c=0;c<l.length;c++)e(l[c]);var u=o;n.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},1:function(t,e){},2:function(t,e){},"56d7":function(t,e,s){"use strict";s.r(e);s("cadf"),s("551c"),s("f751"),s("097d");var a=s("2b0e"),i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("nav-bar"),s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[t._m(0),s("div",{staticClass:"field is-horizontal"},[t._m(1),s("div",{staticClass:"field-body"},[s("div",{staticClass:"field is-narrow"},[s("div",{staticClass:"control"},[s("div",{staticClass:"select is-fullwidth"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.bo,expression:"bo"}],on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.bo=e.target.multiple?s:s[0]},t.onTaskChange]}},[s("option",{attrs:{value:"0"}},[t._v("Baca form dan beri nilai")]),s("option",{attrs:{value:"1"}},[t._v("Hanya baca form")])])])])])])]),s("div",{staticClass:"field is-narrow is-horizontal"},[t._m(2),s("div",{staticClass:"field-body"},[s("div",{staticClass:"field is-narrow has-addons"},[s("div",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.formInfo,expression:"formInfo"}],staticClass:"input",attrs:{type:"text",readonly:""},domProps:{value:t.formInfo},on:{input:function(e){e.target.composing||(t.formInfo=e.target.value)}}})]),s("div",{staticClass:"control"},[s("button",{directives:[{name:"show",rawName:"v-show",value:null!==t.cj,expression:"cj!==null"}],staticClass:"button is-danger",on:{click:t.btnTokenClear}},[t._v("Hapus")])]),s("div",{staticClass:"control"},[s("button",{directives:[{name:"show",rawName:"v-show",value:null===t.cj,expression:"cj===null"}],staticClass:"button is-primary",class:{"is-loading":t.sendTokenLoading},on:{click:t.showTokenIdDlg}},[t._v("Token")])])])])]),s("div",{staticClass:"field is-horizontal"},[t._m(3),s("div",{staticClass:"field-body"},[s("div",{staticClass:"field is-narrow"},[s("div",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.bl,expression:"bl",modifiers:{number:!0}}],staticClass:"input",attrs:{type:"number",min:"1",max:t.cl,disabled:t.az||t.bg},domProps:{value:t.bl},on:{input:function(e){e.target.composing||(t.bl=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])])])]),s("div",{directives:[{name:"show",rawName:"v-show",value:"0"===t.bo&&null!==t.cj,expression:"(bo==='0') && (cj!==null)"}],staticClass:"field is-horizontal"},[t._m(4),s("div",{staticClass:"field-body"},[s("div",{staticClass:"field is-grouped"},[s("div",{staticClass:"control",class:{"is-loading":t.bg}},[s("div",{staticClass:"file has-name"},[s("label",{staticClass:"file-label"},[s("input",{ref:"anskfile",staticClass:"file-input",attrs:{type:"file",accept:".png",disabled:t.bf},on:{change:t.onAnsKFCh}}),t._m(5),s("span",{staticClass:"file-name"},[t._v(t._s(t.bh))])])])]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.az,expression:"az"}],staticClass:"control"},[s("button",{staticClass:"button is-small is-danger",on:{click:t.onClrAnsKClick}},[t._v("Hapus")]),s("button",{staticClass:"button is-small is-info",on:{click:function(e){t.ansKLstDlg=!0}}},[t._v("Lihat")])])])])]),s("div",{staticClass:"field is-horizontal"},[t._m(6),s("div",{staticClass:"field-body"},[s("div",{staticClass:"field is-narrow"},[s("div",{staticClass:"control"},[s("div",{staticClass:"file has-name"},[s("label",{staticClass:"file-label"},[s("input",{ref:"inputFiles",staticClass:"file-input",attrs:{type:"file",multiple:"",accept:".png"},on:{change:t.onInFilesCh}}),t._m(7),s("span",{staticClass:"file-name"},[t._v(t._s(t.inFilesName))])])])])])])]),s("div",{staticClass:"field is-horizontal"},[t._m(8),s("div",{staticClass:"field-body"},[s("div",{staticClass:"field is-narrow is-grouped"},[s("div",{staticClass:"control"},[s("div",{staticClass:"file has-name"},[s("label",{staticClass:"file-label"},[s("input",{ref:"namelstfile",staticClass:"file-input",attrs:{type:"file",accept:".csv"},on:{change:t.onNamesFileChange}}),t._m(9),s("span",{staticClass:"file-name"},[t._v(t._s(t.nmListFName))])])]),s("p",{staticClass:"help"},[t._v("* Opsional")])]),s("div",{staticClass:"control"},[s("button",{directives:[{name:"show",rawName:"v-show",value:t.useNameLst,expression:"useNameLst"}],staticClass:"button is-small is-danger",on:{click:t.clrNameLst}},[t._v("Hapus")]),s("button",{directives:[{name:"show",rawName:"v-show",value:t.useNameLst,expression:"useNameLst"}],staticClass:"button is-small is-info",on:{click:function(e){t.nameLstDlg=!0}}},[t._v("Lihat")])])])])]),s("div",{staticClass:"field is-grouped is-grouped-centered"},[s("div",{staticClass:"control"},[s("button",{staticClass:"button is-danger",on:{click:function(e){return e.stopPropagation(),t.onBtnResetClick(e)}}},[t._v("Reset")])]),t._m(10),s("div",{directives:[{name:"show",rawName:"v-show",value:t.reqsOK,expression:"reqsOK"}],staticClass:"control"},[s("button",{staticClass:"button is-primary",on:{click:t.startRead}},[t._v("Proses")])]),s("div",{staticClass:"control"},[s("button",{directives:[{name:"show",rawName:"v-show",value:t.bm.length>0,expression:"bm.length>0"}],staticClass:"button is-primary",on:{click:function(e){t.omrResultDlg=!0}}},[t._v("Hasil")])])])]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.bp.length>0,expression:"bp.length>0"}],staticClass:"notification is-danger",staticStyle:{"margin-top":"16px"}},[s("h4",{staticClass:"title is-4"},[t._v("File Tidak Terbaca")]),s("p",[t._v(t._s(t.unrecogLst))])])]),s("contact-form"),t._m(11),s("div",{staticClass:"modal",class:{"is-active":t.tokenIdDlg}},[s("div",{staticClass:"modal-background"}),s("div",{staticClass:"modal-content",staticStyle:{width:"320px"}},[s("div",{staticClass:"box"},[s("div",{staticStyle:{"margin-bottom":"16px"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.tokenIdInput,expression:"tokenIdInput"}],ref:"tokenIdInput",staticClass:"input",attrs:{type:"password",placeholder:"Token akses"},domProps:{value:t.tokenIdInput},on:{input:function(e){e.target.composing||(t.tokenIdInput=e.target.value)}}})]),s("div",{staticClass:"columns has-text-centered"},[s("div",{staticClass:"column is-one-quarter is-offset-half"},[s("button",{staticClass:"button",on:{click:function(e){t.tokenIdDlg=!1}}},[t._v("Batal")])]),s("div",{staticClass:"column is-one-quarter"},[s("button",{staticClass:"button is-primary",attrs:{disabled:0===t.tokenIdInput.length},on:{click:t.getSfToken}},[t._v("OK")])])])])])]),s("div",{staticClass:"modal",class:{"is-active":t.ansKLstDlg}},[s("div",{staticClass:"modal-background"}),s("div",{staticClass:"modal-content"},[s("div",{staticClass:"box"},[s("ol",{staticClass:"anskeylist"},t._l(t.ba,function(e,a){return s("li",{key:a},[t._v(t._s(e))])}),0),s("hr"),s("div",{staticStyle:{"text-align":"center"}},[s("button",{staticClass:"button is-primary",on:{click:function(e){t.ansKLstDlg=!1}}},[t._v("Tutup")])])])])]),s("div",{staticClass:"modal",class:{"is-active":t.nameLstDlg}},[s("div",{staticClass:"modal-background"}),s("div",{staticClass:"modal-content",staticStyle:{width:"400px"}},[s("div",{staticClass:"box"},[s("div",{staticClass:"result-table-wrapper"},[s("table",{staticClass:"sf"},[t._m(12),s("tbody",t._l(Object.keys(t.bj).sort(),function(e,a){return s("tr",{key:e},[s("td",[t._v(t._s(a+1))]),s("td",[t._v(t._s(e))]),s("td",[t._v(t._s(t.bj[e]))])])}),0)])]),s("div",{staticStyle:{"text-align":"center","margin-top":"16px"}},[s("button",{staticClass:"button is-primary",on:{click:function(e){t.nameLstDlg=!1}}},[t._v("Tutup")])])])])]),s("div",{staticClass:"modal",class:{"is-active":t.processingDlg}},[s("div",{staticClass:"modal-background"}),s("div",{staticClass:"modal-content",staticStyle:{width:"360px"}},[s("div",{staticClass:"box"},[s("progress",{staticClass:"progress is-primary",attrs:{max:"100"},domProps:{value:t.omrProgress}},[t._v(t._s(t.omrProgress)+"%")]),s("div",{staticStyle:{"text-align":"center"}},[t._v("Memproses "+t._s(t.procFileName)+" ...")]),s("div",{staticStyle:{"text-align":"center"}},[s("button",{staticClass:"button is-primary",class:{"is-loading":t.bc},on:{click:function(e){t.bc=!0}}},[t._v("Batal")])])])])]),s("div",{staticClass:"modal",class:{"is-active":t.omrResultDlg}},[s("div",{staticClass:"modal-background"}),s("div",{staticClass:"modal-card"},[s("section",{staticClass:"modal-card-body"},[s("omr-table",{attrs:{opts:t.resultOpts}})],1),s("footer",{staticClass:"modal-card-foot",staticStyle:{"justify-content":"flex-end"}},[s("button",{staticClass:"button is-primary",on:{click:t.bu}},[t._v("Save Hasil")]),s("button",{directives:[{name:"show",rawName:"v-show",value:"0"===t.bn,expression:"bn==='0'"}],staticClass:"button is-primary",on:{click:t.bv}},[t._v("Save Analisis Soal")]),s("button",{staticClass:"button",on:{click:function(e){t.omrResultDlg=!1}}},[t._v("Tutup")])])])])],1)},n=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("h2",{staticClass:"title"},[t._v("\n        Scan"),s("span",{staticClass:"sf-green"},[t._v("Form")]),t._v(" Custom Form\n      ")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"field-label is-normal"},[s("label",{staticClass:"label"},[t._v("Jenis pekerjaan")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"field-label is-normal"},[s("label",{staticClass:"label"},[t._v("Kode Form")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"field-label is-normal"},[s("label",{staticClass:"label"},[t._v("Jumlah pertanyaan")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"field-label is-normal"},[s("label",{staticClass:"label"},[t._v("Kunci jawaban")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"file-cta"},[s("span",{staticClass:"file-label"},[t._v("Pilih file...")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"field-label is-normal"},[s("label",{staticClass:"label"},[t._v("Form jawaban")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"file-cta"},[s("span",{staticClass:"file-label"},[t._v("Pilih file...")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"field-label is-normal"},[s("label",{staticClass:"label"},[t._v("Daftar nama dan ID")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"file-cta"},[s("span",{staticClass:"file-label"},[t._v("Pilih file...")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"control"},[s("a",{staticClass:"button is-link",attrs:{target:"_blank",href:"./help.html"}},[t._v("Keterangan")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("footer",{staticClass:"footer"},[s("div",{staticClass:"content has-text-centered"},[t._v("\n      Â© 2019\n      "),s("strong",[t._v("\n        Scan"),s("span",{staticClass:"sf-green"},[t._v("Form")])])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("th",[t._v("No")]),s("th",[t._v("Nomor ID")]),s("th",[t._v("Nama")])])])}],r=(s("96cf"),s("3b8d")),l=(s("7f7f"),s("369b")),o=s.n(l),c=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("nav",{staticClass:"navbar",attrs:{role:"navigation"}},[s("div",{staticClass:"navbar-brand"},[t._m(0),s("a",{staticClass:"navbar-burger burger",class:{"is-active":t.navBarIsActive},attrs:{role:"button","data-target":"navbarTarget"},on:{click:function(e){t.navBarIsActive=!t.navBarIsActive}}},[s("span"),s("span"),s("span")])]),s("div",{staticClass:"navbar-menu",class:{"is-active":t.navBarIsActive},attrs:{id:"navbarTarget"}},[t._m(1)])])},u=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("a",{staticClass:"navbar-item"},[s("img",{attrs:{src:"/assets/logo_round.png",alt:"Logo"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"navbar-end"},[s("a",{staticClass:"navbar-item",attrs:{href:"/"}},[t._v("Home")]),s("a",{staticClass:"navbar-item is-active"},[t._v("Aplikasi")]),s("a",{staticClass:"navbar-item",attrs:{href:"/doc.html"}},[t._v("Dokumentasi")]),s("a",{staticClass:"navbar-item",attrs:{href:"./#contact"}},[t._v("Kontak")])])}],h={name:"NavBar",data:function(){return{navBarIsActive:!1}}},f=h,m=s("2877"),d=Object(m["a"])(f,c,u,!1,null,null,null),v=d.exports,p=s("e816"),b=s.n(p),g=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},C=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"section has-background-grey-lighter"},[s("div",{staticClass:"container is-fluid"},[s("a",{attrs:{name:"contact"}}),s("h2",{staticClass:"title is-4"},[t._v("Hubungi Kami")]),s("div",{staticClass:"content"},[s("p",[t._v("\n        Apabila anda memiliki pertanyaan atau saran untuk perbaikan aplikasi\n        "),s("strong",[t._v("\n          Scan"),s("span",{staticClass:"sf-green"},[t._v("Form")])]),t._v(", hubungi kami dengan menulis pesan\n        di bawah ini. Kami sangat menghargai segala bentuk partisipasi anda dalam\n        pengembangan alat bantu ini.\n      ")])]),s("form",{attrs:{action:"https://formspree.io/scanform.id@gmail.com",method:"POST"}},[s("div",{staticClass:"field"},[s("div",{staticClass:"control"},[s("input",{staticClass:"input",attrs:{type:"text",name:"name",placeholder:"Nama anda"}})])]),s("div",{staticClass:"field"},[s("div",{staticClass:"control"},[s("input",{staticClass:"input",attrs:{type:"email",name:"email",placeholder:"E-mail anda"}})])]),s("div",{staticClass:"field"},[s("div",{staticClass:"control"},[s("textarea",{staticClass:"textarea",attrs:{name:"message",placeholder:"Tuliskan pesan anda."}})])]),s("div",{staticClass:"field"},[s("div",{staticClass:"control has-text-centered"},[s("button",{staticClass:"button is-link",attrs:{type:"submit"}},[t._v("Kirim")])])])])])])}],_={},k=Object(m["a"])(_,g,C,!1,null,null,null),y=k.exports,w=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"result-table-wrapper"},[s("table",{staticClass:"sf"},[s("thead",[s("tr",[s("th",[t._v("No")]),s("th",[t._v("File")]),s("th",[t._v("Nomor ID")]),t.opts.useNameLst?s("th",[t._v("Nama")]):t._e(),"0"===t.opts.bo?[s("th",[t._v("Benar")]),s("th",[t._v("Salah")]),s("th",[t._v("Nilai")])]:t._e(),t._l(t.opts.bk,function(e){return s("th",{key:e},[t._v(t._s(e))])})],2)]),s("tbody",t._l(t.opts.bm,function(e,a){return s("tr",{key:"_"+a},[s("td",[t._v(t._s(a+1))]),s("td",[t._v(t._s(e[0]))]),s("td",[t._v(t._s(e[1]))]),t.opts.useNameLst?s("td",[t._v(t._s(e[2]))]):t._e(),"0"===t.opts.bo?[s("td",{staticClass:"stats"},[t._v(t._s(e[t.opts.scoreOffset+0]))]),s("td",{staticClass:"stats"},[t._v(t._s(e[t.opts.scoreOffset+1]))]),s("td",{staticClass:"stats"},[t._v(t._s(e[t.opts.scoreOffset+2].toFixed(2)))])]:t._e(),t._l(t.opts.bm[a].slice(t.opts.respOffset),function(e,i){return s("td",{key:a+"_"+i,staticClass:"response"},[t._v(t._s(e))])})],2)}),0)])])},x=[],N={name:"OmrTable",props:["opts"]},j=N,F=Object(m["a"])(j,w,x,!1,null,null,null),I=F.exports;s("28a5");function L(t){var e=t.split(".");if(3!==e.length)throw new Error("Token tidak valid.");var s=atob(e[1]),a=JSON.parse(s);if(void 0===a.aj)throw new Error("Token tidak valid.");var i=Math.floor(Date.now()/1e3);if(i>a.aj)throw new Error("Token kedaluwarsa.");return a}s("55dd"),s("ac4d"),s("8a81"),s("ac6a"),s("f576"),s("9c29");var O,S=s("1b98");O="aHR0cHM6Ly9sb2cubXVrdGkuaWQ=";var D=O,R="/ic.txt",T="",$="",z="";function E(){if(""!==T)return T;if(T=localStorage.getItem("machine_id"),null!==T)return T;var t=new Uint32Array(2),e=crypto.getRandomValues(t);return T="".concat(e[0]).concat(e[1]),localStorage.setItem("machine_id",T),T}function K(){return""!==$?$:($=atob(D),$)}function P(){return""!==z?z:(z=K()+R,z)}function A(t){return B.apply(this,arguments)}function B(){return B=Object(r["a"])(regeneratorRuntime.mark(function t(e){var s,a,i,n,r,l,o,c,u,h;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return s=new Date,a="0"===e.bn?"data penilaian "+s.toDateString():"data jawaban "+s.toDateString(),t.next=4,prompt("Nama file",a);case 4:if(i=t.sent,null!==i){t.next=7;break}return t.abrupt("return");case 7:for(n={filename:i,sheet:{data:[[{value:"File",type:"string"},{value:"Nomor ID",type:"string"}]]}},e.useNameLst&&n.sheet.data[0].push({value:"Nama",type:"string"}),"0"===e.bn&&n.sheet.data[0].push({value:"Benar",type:"string"},{value:"Salah",type:"string"},{value:"Nilai",type:"string"}),r=0;r<e.bk;r++)n.sheet.data[0].push({value:"".concat(r+1),type:"string"});for(o=0;o<e.bm.length;o++){for(c=e.bm[o],u=[{value:c[0],type:"string"},{value:c[1],type:"string"}],l=2,e.useNameLst&&(u.push({value:c[2],type:"string"}),l=3),"0"===e.bn&&(u.push({value:c[l+0],type:"number"},{value:c[l+1],type:"number"},{value:c[l+2],type:"number"}),l+=3),h=l;h<c.length;h++)u.push({value:c[h],type:"string"});n.sheet.data.push(u)}Object(S["a"])(n);case 13:case"end":return t.stop()}},t)})),B.apply(this,arguments)}function M(t,e,s,a){return H.apply(this,arguments)}function H(){return H=Object(r["a"])(regeneratorRuntime.mark(function t(e,s,a,i){var n,r,l,o,c,u,h,f,m,d,v,p,b,g,C,_,k,y,w,x,N,j,F,I,L,O,D,R,T,$,z,E,K;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return n=new Date,r="analisis soal "+n.toDateString(),t.next=4,prompt("Nama file?",r);case 4:if(l=t.sent,null!==l){t.next=7;break}return t.abrupt("return");case 7:for(o=[],c=[],u=[],h=[],f={},m=5,a&&(m=6),d=0;d<e.length;d++)for(v=m;v<e[d].length;v++)p=e[d][v],p.length>1&&(p=" "),-1===h.indexOf(p)&&(h.push(p),f[p]=0);for(h=h.sort(),b=0;b<i;b++){for(C in g={},f)g[C]=0;o.push(g)}for(_=0;_<e.length;_++)for(k=0;k<i;k++)y=e[_][m+k],y.length>1&&(y=" "),o[k][y]+=1;for(w=0;w<i;w++){for(x=0,N=0;N<h.length;N++)x+=o[w][h[N]];for(j={},F=0;F<h.length;F++)j[h[F]]=100*o[w][h[F]]/x;c.push(j),u.push(c[w][s[w]])}for(I={filename:l,sheet:{data:[[{value:"",type:"string"},{value:"Jumlah memilih",type:"string"}]]}},L=1;L<h.length;L++)I.sheet.data[0].push({value:"",type:"string"});for(I.sheet.data[0].push({value:"Persen memilih (%)",type:"string"}),O=1;O<h.length;O++)I.sheet.data[0].push({value:"",type:"string"});for(I.sheet.data[0].push({value:"Persen menjawab (%)",type:"string"}),I.sheet.data.push([{value:"Nomor soal",type:"string"}]),D=0;D<2;D++)for(R=0;R<h.length;R++)T=h[R]," "===T&&(T="Blank/multi"),I.sheet.data[1].push({value:T,type:"string"});for(I.sheet.data[1].push({value:"Benar",type:"string"}),I.sheet.data[1].push({value:"Salah",type:"string"}),$=0;$<i;$++){for(z=[{value:$+1,type:"number"}],E=0;E<h.length;E++)z.push({value:o[$][h[E]],type:"number"});for(K=0;K<h.length;K++)z.push({value:c[$][h[K]],type:"number"});z.push({value:u[$],type:"number"}),z.push({value:100-u[$],type:"number"}),I.sheet.data.push(z)}Object(S["a"])(I);case 30:case"end":return t.stop()}},t)})),H.apply(this,arguments)}function q(t){var e="".concat(t.getDate());e=e.padStart(2,"0");var s="".concat(t.getMonth()+1);s=s.padStart(2,"0");var a="".concat(t.getFullYear());return e+"/"+s+"/"+a}function J(t){var e=t.f-t.s,s={m:E(),t:t.t,q:t.q,n:t.n,j:t.j,s:t.s,d:e},a=P(),i=btoa(JSON.stringify(s)),n="".concat(a,"?z=").concat(i);fetch(n).then(function(t){}).catch(function(t){})}function U(t){var e=0,s=!0,a=!1,i=void 0;try{for(var n,r=t.ak[Symbol.iterator]();!(s=(n=r.next()).done);s=!0){var l=n.value;if("k"===l.ax){var o=!0,c=!1,u=void 0;try{for(var h,f=l.ad[Symbol.iterator]();!(o=(h=f.next()).done);o=!0){var m=h.value;"d"===m.au||"f"===m.au?e+=m.as:e+=m.ae}}catch(d){c=!0,u=d}finally{try{o||null==f.return||f.return()}finally{if(c)throw u}}break}}}catch(d){a=!0,i=d}finally{try{s||null==r.return||r.return()}finally{if(a)throw i}}return e}var W={name:"app",components:{ContactForm:y,NavBar:v,OmrTable:I},data:function(){return{ansKLstDlg:!1,context:{},inFilesName:"belum memilih",inFilesNum:0,inFilesRemaining:0,nameLstDlg:!1,nmListFName:"belum memilih",omrProgress:0,omrResultDlg:!1,az:!1,ba:[],bc:!1,bd:!1,bf:!1,bg:!1,bh:"belum memilih",cl:1,bj:{},bk:0,bl:1,bm:[],bn:"0",cj:null,ck:K()+"/sft",bo:"0",bp:[],processingDlg:!1,procFileName:"",resultOpts:{},sendTokenLoading:!1,tokenIdInput:"",tokenIdDlg:!1,useNameLst:!1,worker:new b.a,workerReady:!1,zc:document.getElementById("zc"),zctx:document.getElementById("zc").getContext("2d"),omrStartTime:0}},watch:{bl:function(t){(t<1||t>this.cl)&&(this.bl=this.cl)}},computed:{formInfo:function(){if(null===this.cj)return"";var t=new Date(1e3*this.cj.aj),e=q(t);return"".concat(this.cj.bx," (exp. ").concat(e,")")},reqsOK:function(){return"0"===this.bo?!!(null!==this.cj&&this.workerReady&&this.az&&this.bd&&this.bl>0&&this.bl<=this.cl):!!(null!==this.cj&&this.workerReady&&this.bd&&this.bl>0&&this.bl<=this.cl)},respOffset:function(){return this.useNameLst?"0"===this.bo?6:3:"0"===this.bo?5:2},scoreOffset:function(){return this.useNameLst?3:2},unrecogLst:function(){return 0===this.bp.length?"":this.bp.join(", ")}},created:function(){document.getElementById("logo-loading").style.display="none";var t=localStorage.getItem("sf:sft");if(null!==t)try{this.cj=L(t),this.cl=U(this.cj),this.bl=this.cl}catch(e){}this.worker.addEventListener("message",this.onWorkerMessage,!1)},beforeDestroy:function(){this.worker.terminate()},methods:{btnTokenClear:function(){localStorage.removeItem("sf:sftid"),localStorage.removeItem("sf:sft"),this.cj=null,this.bl=1,this.cl=1},clrNameLst:function(){this.bm=[],this.bp=[],this.$refs.namelstfile.value="",this.bj={},this.useNameLst=!1,this.nmListFName="belum memilih"},br:function(t,e,s){var a=this,i=URL.createObjectURL(this.$refs.inputFiles.files[t]),n=new Image;n.onload=function(i){a.zc.width=n.width,a.zc.height=n.height,a.zctx.drawImage(n,0,0);var r=a.zctx.getImageData(0,0,a.zc.width,a.zc.height).data.buffer;a.context.file=a.$refs.inputFiles.files[t].name,a.context.width=a.zc.width,a.context.height=a.zc.height,a.context.job="grade",a.procFileName=a.$refs.inputFiles.files[t].name,a.worker.postMessage({cmd:"read",buf:r,formSettings:e,context:s},[r])},n.src=i},bu:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e={bn:this.bn,useNameLst:this.useNameLst,bk:this.bk,bm:this.bm},A(e);case 2:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),bv:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:M(this.bm,this.ba,this.useNameLst,this.bk);case 1:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),getSfToken:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e,s,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.tokenIdDlg=!1,e="".concat(this.ck,"/").concat(this.tokenIdInput,".sft"),t.prev=2,this.sendTokenLoading=!0,t.next=6,fetch(e);case 6:return s=t.sent,t.next=9,s.text();case 9:a=t.sent,this.cj=L(a),this.onClrAnsKClick(),localStorage.setItem("sf:sftid",this.tokenIdInput),localStorage.setItem("sf:sft",a),i=Math.round(Date.now()/1e3),localStorage.setItem("sf:sftlastdnld","".concat(i)),this.cl=U(this.cj),this.bl=this.cl,this.sendTokenLoading=!1,t.next=25;break;case 21:t.prev=21,t.t0=t["catch"](2),this.sendTokenLoading=!1,t.t0 instanceof TypeError?alert("Token tidak valid."):alert(t.t0.message);case 25:case"end":return t.stop()}},t,this,[[2,21]])}));function e(){return t.apply(this,arguments)}return e}(),logStatistics:function(t){var e=Date.now();this.omrStartTime;J({t:this.cj.am,q:this.bl,n:t,j:this.bo,s:this.omrStartTime,f:e})},onAnsKFCh:function(t){if(0!=t.target.files.length){if(this.bl<1||this.bl>this.cl)return this.$refs.anskfile.value="",void this.onNoAnsKeyF();var e=t.target.files[0];if("image/png"===e.type){var s=URL.createObjectURL(e),a=new Image,i=this;a.onload=function(t){i.zc.width=a.width,i.zc.height=a.height,i.zctx.drawImage(a,0,0);var s=i.zctx.getImageData(0,0,i.zc.width,i.zc.height).data.buffer;i.context.file=e.name,i.context.width=i.zc.width,i.context.height=i.zc.height,i.context.bb=127,i.context.bl=i.bl,i.context.job="anskey",i.bh="",i.bg=!0,i.bf=!0,i.worker.postMessage({cmd:"read",buf:s,formSettings:i.cj,context:i.context},[s])},a.src=s}else this.onNoAnsKeyF()}else this.onNoAnsKeyF()},onBtnResetClick:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,confirm("Yakin untuk mereset?");case 2:if(e=t.sent,e){t.next=5;break}return t.abrupt("return");case 5:this.$refs.anskfile.value="",this.$refs.inputFiles.value="",this.$refs.namelstfile.value="",this.bh="belum memilih",this.inFilesName="belum memilih",this.nmListFName="belum memilih",this.bl=this.cl,this.bk=this.cl,this.bo="0",this.bn="0",this.az=!1,this.bd=!1,this.ba=[],this.bj={},this.useNameLst=!1,this.bm=[],this.bp=[];case 22:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),onClrAnsKClick:function(){this.$refs.anskfile.value="",this.ba=[],this.az=!1,this.bh="belum memilih"},onInFilesCh:function(t){t.target.files.length>0?(this.bd=!0,this.inFilesName="".concat(t.target.files.length," file dipilih")):(this.bd=!1,this.inFilesName="belum memilih")},onNamesFileChange:function(t){if(this.bm=[],this.bp=[],0===t.target.files.length)return this.useNameLst=!1,this.bj={},void(this.nmListFName="belum memilih");if("text/csv"!==t.target.files[0].type)return this.$refs.namelstfile.value="",this.useNameLst=!1,this.bj={},void(this.nmListFName="belum memilih");var e=this;o.a.parse(t.target.files[0],{complete:function(s){e.bj={};for(var a=1;a<s.data.length;a++)s.data[a].length<2||(e.bj[s.data[a][0]]=s.data[a][1]);e.useNameLst=!0,e.nmListFName=t.target.files[0].name}})},onNoAnsKeyF:function(){this.az=!1,this.bh="belum memilih"},onTaskChange:function(){this.bm=[],this.bp=[],"1"===this.bo&&(this.ba=[],this.az=!1,this.$refs.anskfile.value="",this.onNoAnsKeyF())},onWorkerInfo:function(t){switch(t.code){case 0:this.workerReady=!0;break;default:break}},onWorkerMessage:function(t){var e;switch(t.data.type){case"read":if("anskey"===t.data.job){if(this.bg=!1,this.bf=!1,200!==t.data.response.code){this.onNoAnsKeyF(),this.$refs.anskfile.value="";break}this.ba=t.data.response.data[1],this.bh=t.data.file,this.az=!0;break}if(200===t.data.response.code){var s=t.data.response.data,a=s[0].join("").trim(),i=[t.data.file,a];if(this.useNameLst&&i.push(this.bj[a]||""),"0"===this.bo){i.push(0,0,0);for(var n=0,r=0;r<s[1].length;r++)" "===this.ba[r]?n+=1:this.ba[r]===s[1][r]&&(n+=1),i.push(s[1][r]);i[this.scoreOffset]=n,i[this.scoreOffset+1]=this.bl-n,i[this.scoreOffset+2]=100*n/this.bl}else for(var l=0;l<s[1].length;l++)i.push(s[1][l]);this.bm.push(i)}else this.bp.push(t.data.file);if(this.inFilesRemaining--,this.inFilesRemaining>0){if(this.bc){this.bm=[],this.bp=[],this.bc=!1,this.processingDlg=!1;break}e=this.inFilesNum-this.inFilesRemaining,this.omrProgress=Math.round(100*e/this.inFilesNum);while(1){if(e=this.inFilesNum-this.inFilesRemaining,"image/png"!==this.$refs.inputFiles.files[e].type){if(this.inFilesRemaining--,this.inFilesRemaining>0)continue;this.processingDlg=!1,this.showResultDlg(),this.logStatistics();break}this.br(e,this.cj,this.context);break}}else this.processingDlg=!1,this.showResultDlg(),this.logStatistics();break;case"info":this.onWorkerInfo(t.data);break;default:break}},showResultDlg:function(){this.bk=this.bl,this.resultOpts={bo:this.bo,useNameLst:this.useNameLst,bk:this.bk,scoreOffset:this.scoreOffset,respOffset:this.respOffset,bm:this.bm},this.omrResultDlg=!0},showTokenIdDlg:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e=this,this.tokenIdInput="",this.tokenIdDlg=!0,a["a"].nextTick().then(function(){e.$refs.tokenIdInput.focus()});case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),startRead:function(){if(this.inFilesNum=this.$refs.inputFiles.files.length,0!==this.inFilesNum){var t;this.inFilesRemaining=this.$refs.inputFiles.files.length,this.bm=[],this.bp=[],this.bn=this.bo,this.processingDlg=!0,this.bc=!1,this.omrProgress=0,this.context.bb=127,this.context.bl=this.bl,this.context.job="grade",this.omrStartTime=Date.now();while(1){if(t=this.inFilesNum-this.inFilesRemaining,"image/png"===this.$refs.inputFiles.files[t].type){this.br(t,this.cj,this.context);break}this.inFilesRemaining--}}}}},V=W,Y=Object(m["a"])(V,i,n,!1,null,null,null),G=Y.exports;s("92c6"),s("eb7c");function Q(){E()}a["a"].config.productionTip=!1,Q(),new a["a"]({render:function(t){return t(G)}}).$mount("#app")},e816:function(t,e,s){t.exports=function(){return new Worker(s.p+"aa7339ce0c67748507f4.worker.js")}},eb7c:function(t,e,s){}});
//# sourceMappingURL=app.f8a47068.js.map